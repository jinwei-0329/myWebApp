<!DOCTYPE html>
<html>
<script>
  async function loadProfile() {
    const res = await fetch('/get-profile');
    const data = await res.json();

    document.querySelector('#name').textContent = data.name || "Not set";
    document.querySelector('#email').textContent = data.email || "Not set";
    document.querySelector('#interests').textContent = data.interests || "Not set";
  }

  function editProfile() {
    document.querySelector('.container').style.display = 'none';
    document.querySelector('.container-edit').style.display = 'block';

    document.querySelector('#input-name').value = document.querySelector('#name').textContent;
    document.querySelector('#input-email').value = document.querySelector('#email').textContent;
    document.querySelector('#input-interests').value = document.querySelector('#interests').textContent;
  }

  async function saveProfile() {
    const updatedProfile = {
      name: document.querySelector('#input-name').value,
      email: document.querySelector('#input-email').value,
      interests: document.querySelector('#input-interests').value,
    };

    // call backend API
    await fetch('/update-profile', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(updatedProfile)
    });

    // reload profile from server
    await loadProfile();

    document.querySelector('.container').style.display = 'block';
    document.querySelector('.container-edit').style.display = 'none';
  }

  // load profile on page load
  window.onload = loadProfile();
</script>


<head>
  <title>My Backend UI App</title>
  <!--<link rel="stylesheet" href="style.css">-->
  <style>
    /* hide edit form initially */
    .container-edit {
      display: none;   
    }
  </style>
</head>

<body>
  <!--container-->
  <div class="container">
    <h1 id="header">User Profile</h1>
    <img src="profile-picture">
    <br/>
    Name: <h3 id="name">Anna Smith</h3>
    <hr/>
    Email: <h3 id="email">anna.smith@example.com</h3>
    <hr/>
    Interests: <h3 id="interests">coding</h3>
    <hr/>
    <button class="button" onclick="editProfile()">Edit Profile</button>
  </div>

  <!--container-edit-->
  <div class="container-edit">
    <h1 id="header">User Profile</h1>
    <img src="profile-picture">
    <br/>
    Name: <input id="input-name" type="text"/>
    <hr/>
    Email: <input id="input-email" type="email"/>
    <hr/>
    Interests: <input id="input-interests"/>
    <hr/>
    <button class="button" onclick="saveProfile()">Save Profile</button>
  </div>
</body>
</html>